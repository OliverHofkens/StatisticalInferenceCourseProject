---
title: "Statistical Inference Project Part 1"
author: "Oliver Hofkens"
date: "25 May 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part 1: Simulation Exercise

In this report, 1000 random exponentials are simulated and the distribution
of their averages is investigated. The sample mean and variance are compared to 
the theoretical statistics, and it is shown that the distribution is approximately
normal.

### Simulations

Let's start by taking a look at the general form of an exponential.
```{r exp}
library(ggplot2)

set.seed(123456789)
lambda <- 0.2

exampleExp <- rexp(1000, rate = lambda)
exampleExpStats <- summary(exampleExp)
exampleExp <- data.frame(exampleExp)

g <- ggplot(exampleExp, aes(exampleExp)) + 
    geom_histogram() + 
    geom_vline(aes(xintercept = mean(exampleExp), color = 'mean')) + 
    geom_vline(aes(xintercept = sd(exampleExp), color = 'stddev')) +
    xlab('value') + 
    scale_x_continuous(breaks = seq(0, 30, 5))
g
```

We can see that the mean and standard deviation are around 5 for a lambda of 0.2, 
which fits the theoretical values (1/lambda).

Let's generate 1000 random exponentials of 50 samples each for our simulation:
```{r params}
nSimulations <- 1000

# Simulate 1000 random exponentials of 50 samples
sims <- replicate(nSimulations, rexp(50, rate = lambda))
```

### Mean: Sample vs Theoretical

We calculate the mean of each simulation, and plot the results:
```{r}
# calculate the mean of each simulation
means <- apply(sims, 2, mean)
mua <- mean(means)
sda <- sd(means) 

means <- data.frame(means)

g <- ggplot(means, aes(means)) + 
    geom_histogram(aes(y = ..density..)) +
    geom_vline(aes(xintercept = mua, color = 'mean')) + 
    geom_vline(aes(xintercept = mua + sda, color = 'stddev')) +
    geom_vline(aes(xintercept = mua - sda, color = 'stddev')) +
    stat_function(fun = dnorm, args = list(mean = mua, sd = sda))
g
```

```{r theoretical}
mu0 <- 1/lambda
sd0 <- 1/lambda
```
